<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Topic 9 Local Regression &amp; GAMs | STAT 253: Statistical Machine Learning</title>
  <meta name="description" content="This is the class website for Statistical Machine Learning at Macalester College." />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="Topic 9 Local Regression &amp; GAMs | STAT 253: Statistical Machine Learning" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is the class website for Statistical Machine Learning at Macalester College." />
  <meta name="github-repo" content="JamesNormington/253_spring_2023" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Topic 9 Local Regression &amp; GAMs | STAT 253: Statistical Machine Learning" />
  
  <meta name="twitter:description" content="This is the class website for Statistical Machine Learning at Macalester College." />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="splines.html"/>
<link rel="next" href="logistic-regression.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="custom_styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href = "./">STAT 253: Statistical Machine Learning</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a></li>
<li class="chapter" data-level="" data-path="schedule-syllabus.html"><a href="schedule-syllabus.html"><i class="fa fa-check"></i>Schedule &amp; Syllabus</a></li>
<li class="chapter" data-level="" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="r-and-rstudio-setup.html"><a href="r-and-rstudio-setup.html"><i class="fa fa-check"></i>R and RStudio Setup</a>
<ul>
<li class="chapter" data-level="" data-path="r-and-rstudio-setup.html"><a href="r-and-rstudio-setup.html#troubleshooting"><i class="fa fa-check"></i>Troubleshooting</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introductions.html"><a href="introductions.html"><i class="fa fa-check"></i><b>1</b> Introductions</a>
<ul>
<li class="chapter" data-level="" data-path="introductions.html"><a href="introductions.html#envisioning-a-community-of-learners"><i class="fa fa-check"></i>Envisioning a Community of Learners</a></li>
<li class="chapter" data-level="" data-path="introductions.html"><a href="introductions.html#explorations"><i class="fa fa-check"></i>Explorations</a></li>
</ul></li>
<li class="part"><span><b>I Regression: Evaluation</b></span></li>
<li class="chapter" data-level="2" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html"><i class="fa fa-check"></i><b>2</b> Evaluating Regression Models</a>
<ul>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#learning-goals"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#exercises"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#context"><i class="fa fa-check"></i>Context</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#class-investigations"><i class="fa fa-check"></i>Class investigations</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#exercise-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#exercise-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#exercise-3"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#exercise-4"><i class="fa fa-check"></i>Exercise 4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="overfitting.html"><a href="overfitting.html"><i class="fa fa-check"></i><b>3</b> Overfitting</a>
<ul>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#learning-goals-1"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#the-tidymodels-package"><i class="fa fa-check"></i>The <code>tidymodels</code> package</a></li>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#exercises-1"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#context-1"><i class="fa fa-check"></i>Context</a></li>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#exercise-1-5-models"><i class="fa fa-check"></i>Exercise 1: 5 models</a></li>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#exercise-2-evaluating-the-test-data"><i class="fa fa-check"></i>Exercise 2: Evaluating the Test Data</a></li>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#exercise-3-overfitting"><i class="fa fa-check"></i>Exercise 3: Overfitting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cross-validation.html"><a href="cross-validation.html"><i class="fa fa-check"></i><b>4</b> Cross-validation</a>
<ul>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#learning-goals-2"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#exercises-2"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#context-2"><i class="fa fa-check"></i>Context</a></li>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#exercise-1-cross-validation-in-concept"><i class="fa fa-check"></i>Exercise 1: Cross-validation in Concept</a></li>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#exercise-2-cross-validation-with-tidymodels"><i class="fa fa-check"></i>Exercise 2: Cross-validation with <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#exercise-3-looking-at-the-evaluation-metrics"><i class="fa fa-check"></i>Exercise 3: Looking at the evaluation metrics</a></li>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#exercise-4-practical-issues-choosing-k"><i class="fa fa-check"></i>Exercise 4: Practical issues: choosing <span class="math inline">\(k\)</span></a></li>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#digging-deeper"><i class="fa fa-check"></i>Digging deeper</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Regression: Building Models</b></span></li>
<li class="chapter" data-level="5" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html"><i class="fa fa-check"></i><b>5</b> Variable Subset Selection</a>
<ul>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#learning-goals-3"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#exercises-3"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#exercise-1-backward-stepwise-selection-by-hand"><i class="fa fa-check"></i>Exercise 1: Backward stepwise selection: by hand</a></li>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#exercise-2-interpreting-the-results"><i class="fa fa-check"></i>Exercise 2: Interpreting the results</a></li>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#exercise-3-planning-forward-selection-using-cv"><i class="fa fa-check"></i>Exercise 3: Planning forward selection using CV</a></li>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#exercise-4-stepwise-selection-in-caret"><i class="fa fa-check"></i>Exercise 4: Stepwise selection in <code>caret</code></a></li>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#exercise-5-exploring-the-results"><i class="fa fa-check"></i>Exercise 5: Exploring the results</a></li>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#digging-deeper-1"><i class="fa fa-check"></i>Digging deeper</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html"><i class="fa fa-check"></i><b>6</b> LASSO: Shrinkage/Regularization</a>
<ul>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#learning-goals-4"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#lasso-models-in-tidymodels"><i class="fa fa-check"></i>LASSO models in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#exercises-4"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#exercise-1-a-least-squares-model"><i class="fa fa-check"></i>Exercise 1: A least squares model</a></li>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#exercise-2-fitting-a-lasso-model-in-tidymodels"><i class="fa fa-check"></i>Exercise 2: Fitting a LASSO model in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#exercise-3-examining-output-plot-of-coefficient-paths"><i class="fa fa-check"></i>Exercise 3: Examining output: plot of coefficient paths</a></li>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#exercise-4-examining-and-evaluating-the-best-lasso-model."><i class="fa fa-check"></i>Exercise 4: Examining and evaluating the best LASSO model.</a></li>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#digging-deeper-2"><i class="fa fa-check"></i>Digging deeper</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Regression: Building Flexible Models</b></span></li>
<li class="chapter" data-level="7" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html"><i class="fa fa-check"></i><b>7</b> KNN Regression and the Bias-Variance Tradeoff</a>
<ul>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#learning-goals-5"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#knn-models-in-tidymodels"><i class="fa fa-check"></i>KNN models in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#exercises-5"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#exercise-1-bias-variance-tradeoff-warmup"><i class="fa fa-check"></i>Exercise 1: Bias-variance tradeoff warmup</a></li>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#exercise-2-impact-of-distance-metric"><i class="fa fa-check"></i>Exercise 2: Impact of distance metric</a></li>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#exercise-3-implementing-knn-in-tidymodels"><i class="fa fa-check"></i>Exercise 3: Implementing KNN in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#exercise-4-inspecting-the-results"><i class="fa fa-check"></i>Exercise 4: Inspecting the results</a></li>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#exercise-5-curse-of-dimensionality"><i class="fa fa-check"></i>Exercise 5: Curse of dimensionality</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="splines.html"><a href="splines.html"><i class="fa fa-check"></i><b>8</b> Splines</a>
<ul>
<li class="chapter" data-level="" data-path="splines.html"><a href="splines.html#learning-goals-6"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="splines.html"><a href="splines.html#splines-in-tidymodels"><i class="fa fa-check"></i>Splines in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="splines.html"><a href="splines.html#exercises-6"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="splines.html"><a href="splines.html#exercise-1-evaluating-a-fully-linear-model"><i class="fa fa-check"></i>Exercise 1: Evaluating a fully linear model</a></li>
<li class="chapter" data-level="" data-path="splines.html"><a href="splines.html#exercise-2-evaluating-a-spline-model"><i class="fa fa-check"></i>Exercise 2: Evaluating a spline model</a></li>
<li class="chapter" data-level="" data-path="splines.html"><a href="splines.html#extra-variable-scaling"><i class="fa fa-check"></i>Extra! Variable scaling</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="local-regression-gams.html"><a href="local-regression-gams.html"><i class="fa fa-check"></i><b>9</b> Local Regression &amp; GAMs</a>
<ul>
<li class="chapter" data-level="" data-path="local-regression-gams.html"><a href="local-regression-gams.html#learning-goals-7"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="9.1" data-path="local-regression-gams.html"><a href="local-regression-gams.html#gams"><i class="fa fa-check"></i><b>9.1</b> GAMs</a></li>
<li class="chapter" data-level="9.2" data-path="local-regression-gams.html"><a href="local-regression-gams.html#gams---options-for-fitting"><i class="fa fa-check"></i><b>9.2</b> GAMs - Options for Fitting</a></li>
<li class="chapter" data-level="" data-path="local-regression-gams.html"><a href="local-regression-gams.html#gams-in-tidymodels"><i class="fa fa-check"></i>GAMs in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="local-regression-gams.html"><a href="local-regression-gams.html#exercises-7"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="local-regression-gams.html"><a href="local-regression-gams.html#exercise-1-conceptual-warmup"><i class="fa fa-check"></i>Exercise 1: Conceptual warmup</a></li>
<li class="chapter" data-level="" data-path="local-regression-gams.html"><a href="local-regression-gams.html#exercise-2-using-loess"><i class="fa fa-check"></i>Exercise 2: Using LOESS</a></li>
<li class="chapter" data-level="" data-path="local-regression-gams.html"><a href="local-regression-gams.html#exercise-3-building-a-gam-in-tidymodels"><i class="fa fa-check"></i>Exercise 3: Building a GAM in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="local-regression-gams.html"><a href="local-regression-gams.html#exercise-4-adjusting-the-best-gam"><i class="fa fa-check"></i>Exercise 4: Adjusting the “best” GAM</a></li>
<li class="chapter" data-level="" data-path="local-regression-gams.html"><a href="local-regression-gams.html#exercise-5-gam-with-recipes"><i class="fa fa-check"></i>Exercise 5: GAM with recipes</a></li>
<li class="chapter" data-level="" data-path="local-regression-gams.html"><a href="local-regression-gams.html#exercise-6-putting-a-bow-on-regression"><i class="fa fa-check"></i>Exercise 6: putting a bow on regression</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Classification</b></span></li>
<li class="chapter" data-level="10" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>10</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#learning-goals-8"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#logistic-regression-in-tidymodels"><i class="fa fa-check"></i>Logistic regression in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#exercises-8"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#context-and-data"><i class="fa fa-check"></i>Context and Data</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#exercise-1-visualization-warmup"><i class="fa fa-check"></i>Exercise 1: Visualization warmup</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#exercise-2-implementing-logistic-regression-in-tidymodels"><i class="fa fa-check"></i>Exercise 2: Implementing logistic regression in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#exercise-3-interpreting-the-model"><i class="fa fa-check"></i>Exercise 3: Interpreting the model</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#exercise-4-making-predictions"><i class="fa fa-check"></i>Exercise 4: Making predictions</a></li>
<li class="chapter" data-level="10.0.1" data-path="logistic-regression.html"><a href="logistic-regression.html#exercise-5-evaluate-the-model"><i class="fa fa-check"></i><b>10.0.1</b> Exercise 5: Evaluate the model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="lasso-logistic-regression.html"><a href="lasso-logistic-regression.html"><i class="fa fa-check"></i><b>11</b> Lasso &amp; Logistic Regression</a>
<ul>
<li class="chapter" data-level="" data-path="lasso-logistic-regression.html"><a href="lasso-logistic-regression.html#learning-goals-9"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="lasso-logistic-regression.html"><a href="lasso-logistic-regression.html#lasso-for-logistic-regression-in-tidymodels"><i class="fa fa-check"></i>LASSO for logistic regression in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="lasso-logistic-regression.html"><a href="lasso-logistic-regression.html#exercises-9"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="lasso-logistic-regression.html"><a href="lasso-logistic-regression.html#context-3"><i class="fa fa-check"></i>Context</a></li>
<li class="chapter" data-level="" data-path="lasso-logistic-regression.html"><a href="lasso-logistic-regression.html#exercise-1-conceptual-warmup-1"><i class="fa fa-check"></i>Exercise 1: Conceptual warmup</a></li>
<li class="chapter" data-level="" data-path="lasso-logistic-regression.html"><a href="lasso-logistic-regression.html#exercise-2-implementing-lasso-logistic-regression-in-tidymodels"><i class="fa fa-check"></i>Exercise 2: Implementing LASSO logistic regression in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="lasso-logistic-regression.html"><a href="lasso-logistic-regression.html#exercise-3-inspecting-the-model"><i class="fa fa-check"></i>Exercise 3: Inspecting the model</a></li>
<li class="chapter" data-level="" data-path="lasso-logistic-regression.html"><a href="lasso-logistic-regression.html#exercise-4-interpreting-evaluation-metrics"><i class="fa fa-check"></i>Exercise 4: Interpreting evaluation metrics</a></li>
<li class="chapter" data-level="" data-path="lasso-logistic-regression.html"><a href="lasso-logistic-regression.html#exercise-5-using-the-final-model-choosing-a-threshold"><i class="fa fa-check"></i>Exercise 5: Using the final model (choosing a threshold)</a></li>
<li class="chapter" data-level="" data-path="lasso-logistic-regression.html"><a href="lasso-logistic-regression.html#exercise-6-algorithmic-understanding-for-evaluation-metrics"><i class="fa fa-check"></i>Exercise 6: Algorithmic understanding for evaluation metrics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="decision-trees.html"><a href="decision-trees.html"><i class="fa fa-check"></i><b>12</b> Decision Trees</a>
<ul>
<li class="chapter" data-level="" data-path="decision-trees.html"><a href="decision-trees.html#learning-goals-10"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="decision-trees.html"><a href="decision-trees.html#trees-in-tidymodels"><i class="fa fa-check"></i>Trees in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="decision-trees.html"><a href="decision-trees.html#exercises-part-1"><i class="fa fa-check"></i>Exercises Part 1</a>
<ul>
<li class="chapter" data-level="" data-path="decision-trees.html"><a href="decision-trees.html#context-4"><i class="fa fa-check"></i>Context</a></li>
<li class="chapter" data-level="" data-path="decision-trees.html"><a href="decision-trees.html#exercise-1-core-theme-parametricnonparametric"><i class="fa fa-check"></i>Exercise 1: Core theme: parametric/nonparametric</a></li>
<li class="chapter" data-level="" data-path="decision-trees.html"><a href="decision-trees.html#exercise-2-core-theme-tuning-parameters-and-the-bvt"><i class="fa fa-check"></i>Exercise 2: Core theme: Tuning parameters and the BVT</a></li>
<li class="chapter" data-level="" data-path="decision-trees.html"><a href="decision-trees.html#exercise-3-building-trees-in-tidymodels"><i class="fa fa-check"></i>Exercise 3: Building trees in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="decision-trees.html"><a href="decision-trees.html#exercise-4-visualizing-trees"><i class="fa fa-check"></i>Exercise 4: Visualizing trees</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="decision-trees.html"><a href="decision-trees.html#exercises-part-2"><i class="fa fa-check"></i>Exercises Part 2</a>
<ul>
<li class="chapter" data-level="" data-path="decision-trees.html"><a href="decision-trees.html#exercise-5-predictions-from-trees"><i class="fa fa-check"></i>Exercise 5: Predictions from Trees</a></li>
<li class="chapter" data-level="" data-path="decision-trees.html"><a href="decision-trees.html#exercise-6-variable-importance-in-trees"><i class="fa fa-check"></i>Exercise 6: Variable importance in trees</a></li>
<li class="chapter" data-level="" data-path="decision-trees.html"><a href="decision-trees.html#exercise-7-regression-trees"><i class="fa fa-check"></i>Exercise 7: REGRESSION trees?!</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>V Homework</b></span></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html"><i class="fa fa-check"></i>Homework 1</a>
<ul>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#project-work"><i class="fa fa-check"></i>Project Work</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#ethics-in-ml"><i class="fa fa-check"></i>Ethics in ML</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#portfolio-work"><i class="fa fa-check"></i>Portfolio Work</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html"><i class="fa fa-check"></i>Homework 2</a>
<ul>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#project-work-1"><i class="fa fa-check"></i>Project Work</a></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#ethics-in-ml-1"><i class="fa fa-check"></i>Ethics in ML</a></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#portfolio-work-1"><i class="fa fa-check"></i>Portfolio Work</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html"><i class="fa fa-check"></i>Homework 3</a>
<ul>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#project-work-2"><i class="fa fa-check"></i>Project Work</a>
<ul>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#note-this-is-a-repeat-of-hw2.-many-of-you-struggled-with-this-section-so-this-gives-you-an-opportunity-to-incorporate-feedback-from-the-preceptors-or-try-additional-models."><i class="fa fa-check"></i>Note: this is a repeat of HW2. Many of you struggled with this section, so this gives you an opportunity to incorporate feedback from the preceptors, or try additional models.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#portfolio-work-2"><i class="fa fa-check"></i>Portfolio Work</a></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html#ethics-in-ml-2"><i class="fa fa-check"></i>Ethics in ML</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-resources.html"><a href="r-resources.html"><i class="fa fa-check"></i>R Resources</a>
<ul>
<li class="chapter" data-level="" data-path="r-resources.html"><a href="r-resources.html#outside-resources"><i class="fa fa-check"></i>Outside resources</a></li>
<li class="chapter" data-level="" data-path="r-resources.html"><a href="r-resources.html#example-code"><i class="fa fa-check"></i>Example code</a></li>
</ul></li>
<li class="part"><span><b>VI Project</b></span></li>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html"><i class="fa fa-check"></i>Final Project</a>
<ul>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html#requirements"><i class="fa fa-check"></i>Requirements</a></li>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html#grading-rubric"><i class="fa fa-check"></i>Grading Rubric</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STAT 253: Statistical Machine Learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="local-regression-gams" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Topic 9</span> Local Regression &amp; GAMs<a href="local-regression-gams.html#local-regression-gams" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="learning-goals-7" class="section level2 unnumbered hasAnchor">
<h2>Learning Goals<a href="local-regression-gams.html#learning-goals-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Clearly describe the local regression algorithm for making a prediction</li>
<li>Explain how bandwidth (span) relate to the bias-variance tradeoff</li>
<li>Describe some different formulations for a GAM (how the arbitrary functions are represented)</li>
<li>Explain how to make a prediction from a GAM</li>
<li>Interpret the output from a GAM</li>
</ul>
<p><br></p>
<p>Slides from today are available <a href="https://docs.google.com/presentation/d/1fb_PCgh4roqaDiNT9xhS6oJsV9I9ZzP4/edit?usp=sharing&amp;ouid=115583691606860124358&amp;rtpof=true&amp;sd=true">here</a>.</p>
<p><br><br><br></p>
</div>
<div id="gams" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> GAMs<a href="local-regression-gams.html#gams" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Generalized Additive Models (GAMs) are extensions of linear models by allowing non-linear functions of any of the variables, while maintaining additivity in the relationships (no interactions; you can keep other variables fixed).</p>
<p>In theory, we imagine that each predictor variable <span class="math inline">\(x_{ij}\)</span> has its own relationship with the outcome, represented by the function <span class="math inline">\(f_j\)</span>:</p>
<p><span class="math inline">\(y_i = \beta_0 + f_1(x_{i1}) + ... + f_p(x_{ip}) + \epsilon_i\)</span></p>
<p>That function could be linear, <span class="math inline">\(f_j(x_{ij}) = \beta_j x_{ij}\)</span>, or non-linear (curved in some way). There are many ways we could model the non-linear functions. We can model non-linear relationships using</p>
<ul>
<li>local regression (LOESS)</li>
<li>basis splines (natural or not)</li>
<li>smoothing splines (fits splines with a penalty term)</li>
</ul>
<p>Smoothing splines are piecewise polynomials with the same properties we talked about before (continuity of function and derivatives) but are estimated with a penalty term. We minimize the penalized least squares,</p>
<p><span class="math inline">\(RSS + \lambda \int g&#39;&#39;(t)^2 dt\)</span></p>
<p><span class="math inline">\(\lambda\)</span> is a tuning parameter often referred to as the degree of smoothness and the spline function <span class="math inline">\(g(t)\)</span> that minimizes this quantity is a smoothing spline. Note: the penalty term looks a bit different from LASSO; the second derivative, <span class="math inline">\(g&#39;&#39;(t)\)</span>, represents how much the slope changes along the function <span class="math inline">\(g\)</span>. We square the changes to remove negative changes and take the integral as a measure of overall “wiggliness” of the function (how much the slope changes along the function).</p>
<p>Large <span class="math inline">\(λ\)</span> penalizes you for having a too “wiggly” function so it may lead to a more simple linear function and small <span class="math inline">\(λ\)</span> allows you to have a more “wiggly” function that may overfit the training data.</p>
</div>
<div id="gams---options-for-fitting" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> GAMs - Options for Fitting<a href="local-regression-gams.html#gams---options-for-fitting" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>B-splines and OLS: use the <code>lm</code> engine with <code>step_ns()</code> (natural) or <code>step_bs()</code> (B-spline)</li>
<li>LOESS: use the <code>gam</code> package</li>
</ul>
</div>
<div id="gams-in-tidymodels" class="section level2 unnumbered hasAnchor">
<h2>GAMs in <code>tidymodels</code><a href="local-regression-gams.html#gams-in-tidymodels" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To build GAMs in <code>tidymodels</code>, first load the package:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="local-regression-gams.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb64-2"><a href="local-regression-gams.html#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb64-3"><a href="local-regression-gams.html#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb64-4"><a href="local-regression-gams.html#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb64-5"><a href="local-regression-gams.html#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels) </span>
<span id="cb64-6"><a href="local-regression-gams.html#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tidymodels_prefer</span>() <span class="co"># Resolves conflicts, prefers tidymodel functions</span></span></code></pre></div>
<p>Then adapt the following code:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="local-regression-gams.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generalized Additive Regression (GAM) Model</span></span>
<span id="cb65-2"><a href="local-regression-gams.html#cb65-2" aria-hidden="true" tabindex="-1"></a>gam_spec <span class="ot">&lt;-</span> </span>
<span id="cb65-3"><a href="local-regression-gams.html#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gen_additive_mod</span>() <span class="sc">%&gt;%</span></span>
<span id="cb65-4"><a href="local-regression-gams.html#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="at">engine =</span> <span class="st">&#39;mgcv&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-5"><a href="local-regression-gams.html#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&#39;regression&#39;</span>) </span>
<span id="cb65-6"><a href="local-regression-gams.html#cb65-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-7"><a href="local-regression-gams.html#cb65-7" aria-hidden="true" tabindex="-1"></a>fit_gam_model <span class="ot">&lt;-</span> gam_spec <span class="sc">%&gt;%</span> <span class="co"># can&#39;t use a recipe with gam (yet)</span></span>
<span id="cb65-8"><a href="local-regression-gams.html#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(y <span class="sc">~</span> <span class="fu">s</span>(x1) <span class="sc">+</span> x2 <span class="sc">+</span> <span class="fu">s</span>(x3), <span class="at">data =</span> train_data) <span class="co"># s() stands for splines, indicating a non-linear relationship  </span></span>
<span id="cb65-9"><a href="local-regression-gams.html#cb65-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-10"><a href="local-regression-gams.html#cb65-10" aria-hidden="true" tabindex="-1"></a><span class="co"># To specify the number of knots, update the formula: s(x1, k = __)</span></span>
<span id="cb65-11"><a href="local-regression-gams.html#cb65-11" aria-hidden="true" tabindex="-1"></a><span class="co"># To specify the degree of smoothing, update the formula: s(x1, sp = __)</span></span></code></pre></div>
<p><strong>Ensuring a good fit for GAM</strong>
The <code>mgcv</code> engine uses generalized cross-validation to select the degree of smoothness for a default number of knots, if these two tuning parameters aren’t specified by the user.</p>
<p>Note: the number of knots must be large enough to capture the true “wiggliness” of the relationship, and the <span class="math inline">\(λ\)</span> penalty does the rest of the work. In <code>mgcv</code>, the default number of knots is arbitrary so you need to run <code>gam.check</code> to make sure there are enough knots.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="local-regression-gams.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary: Parameter (linear) estimates and then Smooth Terms (H0: no relationship)</span></span>
<span id="cb66-2"><a href="local-regression-gams.html#cb66-2" aria-hidden="true" tabindex="-1"></a>fit_gam_model <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="st">&#39;fit&#39;</span>) <span class="sc">%&gt;%</span> <span class="fu">summary</span>() </span>
<span id="cb66-3"><a href="local-regression-gams.html#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="local-regression-gams.html#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostics: Check to see if the number of knots is large enough (if p-value is low, increase number of knots)</span></span>
<span id="cb66-5"><a href="local-regression-gams.html#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb66-6"><a href="local-regression-gams.html#cb66-6" aria-hidden="true" tabindex="-1"></a>fit_gam_model <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="st">&#39;fit&#39;</span>) <span class="sc">%&gt;%</span> mgcv<span class="sc">::</span><span class="fu">gam.check</span>() </span></code></pre></div>
<p><strong>Visualizing the GAM</strong></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="local-regression-gams.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot functions for each predictor</span></span>
<span id="cb67-2"><a href="local-regression-gams.html#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Dashed lines are +/- 2 SEs</span></span>
<span id="cb67-3"><a href="local-regression-gams.html#cb67-3" aria-hidden="true" tabindex="-1"></a>fit_gam_model <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="st">&#39;fit&#39;</span>) <span class="sc">%&gt;%</span> <span class="fu">plot</span>()</span></code></pre></div>
<p><br><br><br></p>
</div>
<div id="exercises-7" class="section level2 unnumbered hasAnchor">
<h2>Exercises<a href="local-regression-gams.html#exercises-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>You can download a template RMarkdown file to start from <a href="template_rmds/09-loess-gams.Rmd">here</a>.</strong></p>
<p>Before proceeding, install the <code>mgcv</code> package by entering <code>install.packages("mgcv")</code> in the Console.</p>
<p>We’ll continue using the <code>College</code> dataset in the <code>ISLR</code> package to explore splines. You can use <code>?College</code> in the Console to look at the data codebook.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="local-regression-gams.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)</span>
<span id="cb68-2"><a href="local-regression-gams.html#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb68-3"><a href="local-regression-gams.html#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb68-4"><a href="local-regression-gams.html#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb68-5"><a href="local-regression-gams.html#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb68-6"><a href="local-regression-gams.html#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels) </span>
<span id="cb68-7"><a href="local-regression-gams.html#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tidymodels_prefer</span>() <span class="co"># Resolves conflicts, prefers tidymodel functions</span></span>
<span id="cb68-8"><a href="local-regression-gams.html#cb68-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-9"><a href="local-regression-gams.html#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(College)</span>
<span id="cb68-10"><a href="local-regression-gams.html#cb68-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-11"><a href="local-regression-gams.html#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="co"># A little data cleaning</span></span>
<span id="cb68-12"><a href="local-regression-gams.html#cb68-12" aria-hidden="true" tabindex="-1"></a>college_clean <span class="ot">&lt;-</span> College <span class="sc">%&gt;%</span> </span>
<span id="cb68-13"><a href="local-regression-gams.html#cb68-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">school =</span> <span class="fu">rownames</span>(College)) <span class="sc">%&gt;%</span> </span>
<span id="cb68-14"><a href="local-regression-gams.html#cb68-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Grad.Rate <span class="sc">&lt;=</span> <span class="dv">100</span>) <span class="co"># Remove one school with grad rate of 118%</span></span>
<span id="cb68-15"><a href="local-regression-gams.html#cb68-15" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(college_clean) <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># Remove school names as row names</span></span></code></pre></div>
<div id="exercise-1-conceptual-warmup" class="section level3 unnumbered hasAnchor">
<h3>Exercise 1: Conceptual warmup<a href="local-regression-gams.html#exercise-1-conceptual-warmup" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: lower-alpha">
<li><p>How does high/low span relate to bias and variance of a local regression (LOESS) model?</p></li>
<li><p>How does high/low lambda relate to bias and variance of a smoothing spline in a GAM model?</p></li>
<li><p>Do you think that a GAM with all possible predictors will have better or worse performance than an ordinary (fully linear) least squares model with all possible predictors? Explain your thoughts.</p></li>
<li><p>How should we choose predictors to be in a GAM? How could forward and backward stepwise selection and LASSO help with variable selection before a GAM? (Don’t answer right away; think about it as you go along in Exercise 2 and come back to this question.)</p></li>
</ol>
</div>
<div id="exercise-2-using-loess" class="section level3 unnumbered hasAnchor">
<h3>Exercise 2: Using LOESS<a href="local-regression-gams.html#exercise-2-using-loess" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: lower-alpha">
<li>Use LOESS (<code>geom_smooth()</code>) to estimate the relationship between <code>Apps</code> and <code>Grad.Rate</code>. Try different values of span between 0 and 1. Write one sentence summarizing what you learned about the relationship between <code>Apps</code> and <code>Grad.Rate</code>.</li>
</ol>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="local-regression-gams.html#cb69-1" aria-hidden="true" tabindex="-1"></a>college_clean <span class="sc">%&gt;%</span></span>
<span id="cb69-2"><a href="local-regression-gams.html#cb69-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Apps, <span class="at">y =</span> Grad.Rate)) <span class="sc">+</span> </span>
<span id="cb69-3"><a href="local-regression-gams.html#cb69-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb69-4"><a href="local-regression-gams.html#cb69-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.2</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb69-5"><a href="local-regression-gams.html#cb69-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20000</span>)) <span class="sc">+</span></span>
<span id="cb69-6"><a href="local-regression-gams.html#cb69-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Use LOESS (<code>geom_smooth()</code>) to estimate the relationship between <code>Apps and Grad.Rate</code>, separately for <code>Private</code> and <code>Non-Private</code> colleges. Try different values of span between 0 and 1. Write one sentence summarizing what you learned about the relationship between <code>Apps</code> and <code>Grad.Rate</code>.</li>
</ol>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="local-regression-gams.html#cb70-1" aria-hidden="true" tabindex="-1"></a>college_clean <span class="sc">%&gt;%</span></span>
<span id="cb70-2"><a href="local-regression-gams.html#cb70-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Apps, <span class="at">y =</span> Grad.Rate, <span class="at">color =</span> Private)) <span class="sc">+</span> </span>
<span id="cb70-3"><a href="local-regression-gams.html#cb70-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb70-4"><a href="local-regression-gams.html#cb70-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.2</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb70-5"><a href="local-regression-gams.html#cb70-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20000</span>)) <span class="sc">+</span></span>
<span id="cb70-6"><a href="local-regression-gams.html#cb70-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span></code></pre></div>
</div>
<div id="exercise-3-building-a-gam-in-tidymodels" class="section level3 unnumbered hasAnchor">
<h3>Exercise 3: Building a GAM in <code>tidymodels</code><a href="local-regression-gams.html#exercise-3-building-a-gam-in-tidymodels" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose that our initial variable selection investigations lead us to using the predictors indicated below in our GAM. Fit a GAM with the following variables in the model.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="local-regression-gams.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb71-2"><a href="local-regression-gams.html#cb71-2" aria-hidden="true" tabindex="-1"></a>gam_spec <span class="ot">&lt;-</span> </span>
<span id="cb71-3"><a href="local-regression-gams.html#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gen_additive_mod</span>() <span class="sc">%&gt;%</span></span>
<span id="cb71-4"><a href="local-regression-gams.html#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="at">engine =</span> <span class="st">&#39;mgcv&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb71-5"><a href="local-regression-gams.html#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&#39;regression&#39;</span>) </span>
<span id="cb71-6"><a href="local-regression-gams.html#cb71-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-7"><a href="local-regression-gams.html#cb71-7" aria-hidden="true" tabindex="-1"></a>gam_mod <span class="ot">&lt;-</span> <span class="fu">fit</span>(gam_spec,</span>
<span id="cb71-8"><a href="local-regression-gams.html#cb71-8" aria-hidden="true" tabindex="-1"></a>    Grad.Rate <span class="sc">~</span> Private <span class="sc">+</span> <span class="fu">s</span>(Apps) <span class="sc">+</span> <span class="fu">s</span>(Top10perc) <span class="sc">+</span> <span class="fu">s</span>(Top25perc) <span class="sc">+</span> <span class="fu">s</span>(P.Undergrad) <span class="sc">+</span> <span class="fu">s</span>(Outstate) <span class="sc">+</span> <span class="fu">s</span>(Room.Board) <span class="sc">+</span> <span class="fu">s</span>(Books) <span class="sc">+</span> <span class="fu">s</span>(Personal) <span class="sc">+</span> <span class="fu">s</span>(PhD) <span class="sc">+</span> <span class="fu">s</span>(perc.alumni),</span>
<span id="cb71-9"><a href="local-regression-gams.html#cb71-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> college_clean</span>
<span id="cb71-10"><a href="local-regression-gams.html#cb71-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li>First, let’s look to see if the default number of knots (10) is large enough for each variable. The <code>edf</code> is the effective degrees of freedom; the larger the <code>edf</code> value, the more wiggly the estimated function is. If <code>edf</code> = 1, it is a straight line. Comment on the diagnostic plots and output.</li>
</ol>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="local-regression-gams.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostics: Check to see if the number of knots is large enough (if p-value is low, increase number of knots)</span></span>
<span id="cb72-2"><a href="local-regression-gams.html#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb72-3"><a href="local-regression-gams.html#cb72-3" aria-hidden="true" tabindex="-1"></a>gam_mod <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="st">&#39;fit&#39;</span>) <span class="sc">%&gt;%</span> mgcv<span class="sc">::</span><span class="fu">gam.check</span>() </span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Next, look at the summary of the output. For parametric (linear) estimates, the coefficients and standard errors are interpreted in the same way as OLS output. The approximate significance of smooth terms is a bit different. The edf is listed for each variable. The p-value is for the null hypothesis that there is no relationship between that predictor and the outcome (meaning the relationship is horizontal line). Do you think we should make any adjustments to the model? Do we need splines for all of these variables?</li>
</ol>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="local-regression-gams.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary: Parameter (linear) estimates and then Smooth Terms (H0: no relationship)</span></span>
<span id="cb73-2"><a href="local-regression-gams.html#cb73-2" aria-hidden="true" tabindex="-1"></a>gam_mod <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="st">&#39;fit&#39;</span>) <span class="sc">%&gt;%</span> <span class="fu">summary</span>() </span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>Lastly, before we make changes to the model, let’s visualize the estimated non-linear functions. What do you notice? What about these plots indicates that using GAM instead of ordinary linear regression was probably a good choice?</li>
</ol>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="local-regression-gams.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize: Look at the estimated non-linear functions</span></span>
<span id="cb74-2"><a href="local-regression-gams.html#cb74-2" aria-hidden="true" tabindex="-1"></a>gam_mod <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="st">&#39;fit&#39;</span>) <span class="sc">%&gt;%</span> <span class="fu">plot</span>( <span class="at">all.terms =</span> <span class="cn">TRUE</span>, <span class="at">pages =</span> <span class="dv">1</span>)</span></code></pre></div>
</div>
<div id="exercise-4-adjusting-the-best-gam" class="section level3 unnumbered hasAnchor">
<h3>Exercise 4: Adjusting the “best” GAM<a href="local-regression-gams.html#exercise-4-adjusting-the-best-gam" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: lower-alpha">
<li>First, let’s consider limiting the training sample given the outliers (the bottom vertical lines on the plot is called a “rug plot” and shows where you have observed values). Look at the outlier colleges.</li>
</ol>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="local-regression-gams.html#cb75-1" aria-hidden="true" tabindex="-1"></a>college_clean <span class="sc">%&gt;%</span></span>
<span id="cb75-2"><a href="local-regression-gams.html#cb75-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Apps <span class="sc">&gt;</span> <span class="dv">30000</span> <span class="sc">|</span> P.Undergrad <span class="sc">&gt;</span> <span class="dv">20000</span>)</span></code></pre></div>
<p>Now that you’ve seen which colleges we are setting aside, let’s refit the model without these two colleges.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="local-regression-gams.html#cb76-1" aria-hidden="true" tabindex="-1"></a>gam_mod2 <span class="ot">&lt;-</span> college_clean <span class="sc">%&gt;%</span></span>
<span id="cb76-2"><a href="local-regression-gams.html#cb76-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(________) <span class="sc">%&gt;%</span></span>
<span id="cb76-3"><a href="local-regression-gams.html#cb76-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fit</span>(gam_spec,</span>
<span id="cb76-4"><a href="local-regression-gams.html#cb76-4" aria-hidden="true" tabindex="-1"></a>    Grad.Rate <span class="sc">~</span> Private <span class="sc">+</span> <span class="fu">s</span>(Apps) <span class="sc">+</span> <span class="fu">s</span>(Top10perc) <span class="sc">+</span> <span class="fu">s</span>(Top25perc) <span class="sc">+</span> <span class="fu">s</span>(P.Undergrad) <span class="sc">+</span> <span class="fu">s</span>(Outstate) <span class="sc">+</span> <span class="fu">s</span>(Room.Board) <span class="sc">+</span> <span class="fu">s</span>(Books) <span class="sc">+</span> <span class="fu">s</span>(Personal) <span class="sc">+</span> <span class="fu">s</span>(PhD) <span class="sc">+</span> <span class="fu">s</span>(perc.alumni),</span>
<span id="cb76-5"><a href="local-regression-gams.html#cb76-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> .</span>
<span id="cb76-6"><a href="local-regression-gams.html#cb76-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Let’s look at the estimated functions again. Pick 1 or 2 of these plots, and interpret your findings.</li>
</ol>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="local-regression-gams.html#cb77-1" aria-hidden="true" tabindex="-1"></a>gam_mod2 <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="st">&#39;fit&#39;</span>) <span class="sc">%&gt;%</span> <span class="fu">summary</span>() </span>
<span id="cb77-2"><a href="local-regression-gams.html#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="local-regression-gams.html#cb77-3" aria-hidden="true" tabindex="-1"></a>gam_mod2 <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="st">&#39;fit&#39;</span>) <span class="sc">%&gt;%</span> <span class="fu">plot</span>( <span class="at">all.terms =</span> <span class="cn">TRUE</span>, <span class="at">pages =</span> <span class="dv">1</span>)</span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li><p>Based on the output above, which variables may not need splines/non-linear relationships? How could we simplify the model?</p></li>
<li><p>Now try fitting a more simple GAM model with <code>tidymodels</code> by only using a non-linear spline function for a variable if the edf is greater than 3 (3 is not a magic number; it is arbitrary).</p></li>
</ol>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="local-regression-gams.html#cb78-1" aria-hidden="true" tabindex="-1"></a>gam_mod3 <span class="ot">&lt;-</span> college_clean <span class="sc">%&gt;%</span></span>
<span id="cb78-2"><a href="local-regression-gams.html#cb78-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(_____) <span class="sc">%&gt;%</span> <span class="co"># remove outliers</span></span>
<span id="cb78-3"><a href="local-regression-gams.html#cb78-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fit</span>(gam_spec,</span>
<span id="cb78-4"><a href="local-regression-gams.html#cb78-4" aria-hidden="true" tabindex="-1"></a>    Grad.Rate <span class="sc">~</span>  ______, <span class="co"># add in the formula</span></span>
<span id="cb78-5"><a href="local-regression-gams.html#cb78-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> .</span>
<span id="cb78-6"><a href="local-regression-gams.html#cb78-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb78-7"><a href="local-regression-gams.html#cb78-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-8"><a href="local-regression-gams.html#cb78-8" aria-hidden="true" tabindex="-1"></a>gam_mod3 <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="st">&#39;fit&#39;</span>) <span class="sc">%&gt;%</span> <span class="fu">summary</span>() </span>
<span id="cb78-9"><a href="local-regression-gams.html#cb78-9" aria-hidden="true" tabindex="-1"></a>gam_mod3 <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="st">&#39;fit&#39;</span>) <span class="sc">%&gt;%</span> <span class="fu">plot</span>() </span></code></pre></div>
</div>
<div id="exercise-5-gam-with-recipes" class="section level3 unnumbered hasAnchor">
<h3>Exercise 5: GAM with recipes<a href="local-regression-gams.html#exercise-5-gam-with-recipes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the edf (round to integer) from above to create a recipe by adding step_ns() for the variables you want model with a non-linear relationship and do CV. Compare this model to one without any splines.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="local-regression-gams.html#cb79-1" aria-hidden="true" tabindex="-1"></a>lm_spec <span class="ot">&lt;-</span></span>
<span id="cb79-2"><a href="local-regression-gams.html#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb79-3"><a href="local-regression-gams.html#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="at">engine =</span> <span class="st">&#39;lm&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-4"><a href="local-regression-gams.html#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&#39;regression&#39;</span>)</span>
<span id="cb79-5"><a href="local-regression-gams.html#cb79-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-6"><a href="local-regression-gams.html#cb79-6" aria-hidden="true" tabindex="-1"></a>data_cv8 <span class="ot">&lt;-</span> college_clean <span class="sc">%&gt;%</span> </span>
<span id="cb79-7"><a href="local-regression-gams.html#cb79-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(___) <span class="sc">%&gt;%</span> <span class="co"># remove outliers</span></span>
<span id="cb79-8"><a href="local-regression-gams.html#cb79-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">vfold_cv</span>(<span class="at">v =</span> <span class="dv">8</span>)</span>
<span id="cb79-9"><a href="local-regression-gams.html#cb79-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-10"><a href="local-regression-gams.html#cb79-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Fully linear model</span></span>
<span id="cb79-11"><a href="local-regression-gams.html#cb79-11" aria-hidden="true" tabindex="-1"></a>college_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Grad.Rate <span class="sc">~</span> Private <span class="sc">+</span> Apps <span class="sc">+</span> Top10perc <span class="sc">+</span> Top25perc <span class="sc">+</span> P.Undergrad <span class="sc">+</span> Outstate <span class="sc">+</span> Room.Board <span class="sc">+</span> Books <span class="sc">+</span> Personal <span class="sc">+</span> PhD <span class="sc">+</span> perc.alumni, <span class="at">data =</span> college_clean)</span>
<span id="cb79-12"><a href="local-regression-gams.html#cb79-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-13"><a href="local-regression-gams.html#cb79-13" aria-hidden="true" tabindex="-1"></a><span class="co"># With splines</span></span>
<span id="cb79-14"><a href="local-regression-gams.html#cb79-14" aria-hidden="true" tabindex="-1"></a>spline_rec <span class="ot">&lt;-</span> college_rec <span class="sc">%&gt;%</span></span>
<span id="cb79-15"><a href="local-regression-gams.html#cb79-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">step_ns</span>(Apps, Top25perc, Room.Board, perc.alumni, <span class="at">deg_free =</span> ___) <span class="sc">%&gt;%</span></span>
<span id="cb79-16"><a href="local-regression-gams.html#cb79-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">step_ns</span>(P.Undergrad, <span class="at">deg_free =</span> ____) <span class="sc">%&gt;%</span></span>
<span id="cb79-17"><a href="local-regression-gams.html#cb79-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">step_ns</span>(Outstate, <span class="at">deg_free =</span> ___) <span class="sc">%&gt;%</span></span>
<span id="cb79-18"><a href="local-regression-gams.html#cb79-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">step_ns</span>(Personal, <span class="at">deg_free =</span> ____)</span>
<span id="cb79-19"><a href="local-regression-gams.html#cb79-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-20"><a href="local-regression-gams.html#cb79-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-21"><a href="local-regression-gams.html#cb79-21" aria-hidden="true" tabindex="-1"></a>college_wf <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb79-22"><a href="local-regression-gams.html#cb79-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_model</span>(lm_spec) <span class="sc">%&gt;%</span></span>
<span id="cb79-23"><a href="local-regression-gams.html#cb79-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_recipe</span>(college_rec)</span>
<span id="cb79-24"><a href="local-regression-gams.html#cb79-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-25"><a href="local-regression-gams.html#cb79-25" aria-hidden="true" tabindex="-1"></a>spline_wf <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb79-26"><a href="local-regression-gams.html#cb79-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_model</span>(lm_spec) <span class="sc">%&gt;%</span></span>
<span id="cb79-27"><a href="local-regression-gams.html#cb79-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_recipe</span>(spline_rec)</span>
<span id="cb79-28"><a href="local-regression-gams.html#cb79-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-29"><a href="local-regression-gams.html#cb79-29" aria-hidden="true" tabindex="-1"></a><span class="fu">fit_resamples</span>(</span>
<span id="cb79-30"><a href="local-regression-gams.html#cb79-30" aria-hidden="true" tabindex="-1"></a>    college_wf,</span>
<span id="cb79-31"><a href="local-regression-gams.html#cb79-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamples =</span> data_cv8, <span class="co"># cv folds</span></span>
<span id="cb79-32"><a href="local-regression-gams.html#cb79-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(mae,rmse,rsq)                     </span>
<span id="cb79-33"><a href="local-regression-gams.html#cb79-33" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">collect_metrics</span>()</span>
<span id="cb79-34"><a href="local-regression-gams.html#cb79-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-35"><a href="local-regression-gams.html#cb79-35" aria-hidden="true" tabindex="-1"></a><span class="fu">fit_resamples</span>(</span>
<span id="cb79-36"><a href="local-regression-gams.html#cb79-36" aria-hidden="true" tabindex="-1"></a>    spline_wf,</span>
<span id="cb79-37"><a href="local-regression-gams.html#cb79-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamples =</span> data_cv8, <span class="co"># cv folds</span></span>
<span id="cb79-38"><a href="local-regression-gams.html#cb79-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(mae,rmse,rsq)                     </span>
<span id="cb79-39"><a href="local-regression-gams.html#cb79-39" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">collect_metrics</span>()</span></code></pre></div>
<p>What do you observe? What do you conclude about these models?</p>
</div>
<div id="exercise-6-putting-a-bow-on-regression" class="section level3 unnumbered hasAnchor">
<h3>Exercise 6: putting a bow on regression<a href="local-regression-gams.html#exercise-6-putting-a-bow-on-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Brainstorm the pros/cons of the different methods that we’ve explored. You may find it helpful to refer to the portfolio themes for each method.</p>
<p>(Soon, as part of the Portfolio, you’ll be doing a similar synthesis of our regression unit, so this brainstorming session might help!)</p>

</div>
</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="splines.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="logistic-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
