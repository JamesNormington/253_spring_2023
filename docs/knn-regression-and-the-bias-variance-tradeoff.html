<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Topic 6 KNN Regression and the Bias-Variance Tradeoff | STAT 253: Statistical Machine Learning</title>
  <meta name="description" content="This is the class website for Statistical Machine Learning at Macalester College." />
  <meta name="generator" content="bookdown 0.21.6 and GitBook 2.6.7" />

  <meta property="og:title" content="Topic 6 KNN Regression and the Bias-Variance Tradeoff | STAT 253: Statistical Machine Learning" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the class website for Statistical Machine Learning at Macalester College." />
  <meta name="github-repo" content="lmyint/253_spring_2021" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Topic 6 KNN Regression and the Bias-Variance Tradeoff | STAT 253: Statistical Machine Learning" />
  
  <meta name="twitter:description" content="This is the class website for Statistical Machine Learning at Macalester College." />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="lasso-shrinkageregularization.html"/>
<link rel="next" href="splines.html"/>
<script src="libs/header-attrs-2.6.4/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="custom_styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href = "./">STAT 253: Statistical Machine Learning</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a></li>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html"><i class="fa fa-check"></i>Schedule</a></li>
<li class="chapter" data-level="" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="r-and-rstudio-setup.html"><a href="r-and-rstudio-setup.html"><i class="fa fa-check"></i>R and RStudio Setup</a>
<ul>
<li class="chapter" data-level="" data-path="r-and-rstudio-setup.html"><a href="r-and-rstudio-setup.html#troubleshooting"><i class="fa fa-check"></i>Troubleshooting</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introductions.html"><a href="introductions.html"><i class="fa fa-check"></i><b>1</b> Introductions</a>
<ul>
<li class="chapter" data-level="" data-path="introductions.html"><a href="introductions.html#envisioning-an-ideal-module-4"><i class="fa fa-check"></i>Envisioning an Ideal Module 4</a></li>
<li class="chapter" data-level="" data-path="introductions.html"><a href="introductions.html#explorations"><i class="fa fa-check"></i>Explorations</a></li>
</ul></li>
<li class="part"><span><b>I Regression: Evaluation</b></span></li>
<li class="chapter" data-level="2" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html"><i class="fa fa-check"></i><b>2</b> Evaluating Regression Models</a>
<ul>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#learning-goals"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#exercises"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#context"><i class="fa fa-check"></i>Context</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#class-investigations"><i class="fa fa-check"></i>Class investigations</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#exercise-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#exercise-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#exercise-3"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#exercise-4"><i class="fa fa-check"></i>Exercise 4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="overfitting-cross-validation.html"><a href="overfitting-cross-validation.html"><i class="fa fa-check"></i><b>3</b> Overfitting &amp; Cross-validation</a>
<ul>
<li class="chapter" data-level="" data-path="overfitting-cross-validation.html"><a href="overfitting-cross-validation.html#learning-goals-1"><i class="fa fa-check"></i>Learning Goals</a></li>
<li><a href="overfitting-cross-validation.html#the-caret-package">The <code>caret</code> package</a></li>
<li class="chapter" data-level="" data-path="overfitting-cross-validation.html"><a href="overfitting-cross-validation.html#exercises-1"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="overfitting-cross-validation.html"><a href="overfitting-cross-validation.html#context-1"><i class="fa fa-check"></i>Context</a></li>
<li class="chapter" data-level="" data-path="overfitting-cross-validation.html"><a href="overfitting-cross-validation.html#exercise-1-4-models"><i class="fa fa-check"></i>Exercise 1: 4 models</a></li>
<li><a href="overfitting-cross-validation.html#exercise-2-cross-validation-with-caret">Exercise 2: Cross-validation with <code>caret</code></a></li>
<li class="chapter" data-level="" data-path="overfitting-cross-validation.html"><a href="overfitting-cross-validation.html#exercise-3-looking-at-the-evaluation-metrics"><i class="fa fa-check"></i>Exercise 3: Looking at the evaluation metrics</a></li>
<li><a href="overfitting-cross-validation.html#exercise-4-practical-issues-choosing-k">Exercise 4: Practical issues: choosing <span class="math inline">\(k\)</span></a></li>
<li class="chapter" data-level="" data-path="overfitting-cross-validation.html"><a href="overfitting-cross-validation.html#digging-deeper"><i class="fa fa-check"></i>Digging deeper</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Regression: Building Models</b></span></li>
<li class="chapter" data-level="4" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html"><i class="fa fa-check"></i><b>4</b> Variable Subset Selection</a>
<ul>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#learning-goals-2"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#exercises-2"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#exercise-1-backward-stepwise-selection-by-hand"><i class="fa fa-check"></i>Exercise 1: Backward stepwise selection: by hand</a></li>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#exercise-2-interpreting-the-results"><i class="fa fa-check"></i>Exercise 2: Interpreting the results</a></li>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#exercise-3-planning-forward-selection-using-cv"><i class="fa fa-check"></i>Exercise 3: Planning forward selection using CV</a></li>
<li><a href="variable-subset-selection.html#exercise-4-stepwise-selection-in-caret">Exercise 4: Stepwise selection in <code>caret</code></a></li>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#exercise-5-exploring-the-results"><i class="fa fa-check"></i>Exercise 5: Exploring the results</a></li>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#digging-deeper-1"><i class="fa fa-check"></i>Digging deeper</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html"><i class="fa fa-check"></i><b>5</b> LASSO: Shrinkage/Regularization</a>
<ul>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#learning-goals-3"><i class="fa fa-check"></i>Learning Goals</a></li>
<li><a href="lasso-shrinkageregularization.html#lasso-models-in-caret">LASSO models in <code>caret</code></a></li>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#exercises-3"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#exercise-1-a-least-squares-model"><i class="fa fa-check"></i>Exercise 1: A least squares model</a></li>
<li><a href="lasso-shrinkageregularization.html#exercise-2-fitting-a-lasso-model-in-caret">Exercise 2: Fitting a LASSO model in <code>caret</code></a></li>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#exercise-3-examining-output-plot-of-coefficient-paths"><i class="fa fa-check"></i>Exercise 3: Examining output: plot of coefficient paths</a></li>
<li><a href="lasso-shrinkageregularization.html#exercise-4-tuning-lambda">Exercise 4: Tuning <span class="math inline">\(\lambda\)</span></a></li>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#exercise-5-examining-and-evaluating-the-best-lasso-model"><i class="fa fa-check"></i>Exercise 5: Examining and evaluating the best LASSO model</a></li>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#digging-deeper-2"><i class="fa fa-check"></i>Digging deeper</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Regression: Building Flexible Models</b></span></li>
<li class="chapter" data-level="6" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html"><i class="fa fa-check"></i><b>6</b> KNN Regression and the Bias-Variance Tradeoff</a>
<ul>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#learning-goals-4"><i class="fa fa-check"></i>Learning Goals</a></li>
<li><a href="knn-regression-and-the-bias-variance-tradeoff.html#knn-models-in-caret">KNN models in <code>caret</code></a></li>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#exercises-4"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#hello-how-are-things"><i class="fa fa-check"></i>Hello, how are things?</a></li>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#exercise-1-bias-variance-tradeoff-warmup"><i class="fa fa-check"></i>Exercise 1: Bias-variance tradeoff warmup</a></li>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#exercise-2-impact-of-distance-metric"><i class="fa fa-check"></i>Exercise 2: Impact of distance metric</a></li>
<li><a href="knn-regression-and-the-bias-variance-tradeoff.html#exercise-3-implementing-knn-in-caret">Exercise 3: Implementing KNN in <code>caret</code></a></li>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#exercise-4-inspecting-the-results"><i class="fa fa-check"></i>Exercise 4: Inspecting the results</a></li>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#exercise-5-curse-of-dimensionality"><i class="fa fa-check"></i>Exercise 5: Curse of dimensionality</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="splines.html"><a href="splines.html"><i class="fa fa-check"></i><b>7</b> Splines</a>
<ul>
<li class="chapter" data-level="" data-path="splines.html"><a href="splines.html#learning-goals-5"><i class="fa fa-check"></i>Learning Goals</a></li>
<li><a href="splines.html#splines-in-caret">Splines in <code>caret</code></a></li>
<li class="chapter" data-level="" data-path="splines.html"><a href="splines.html#exercises-5"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="splines.html"><a href="splines.html#exercise-1-evaluating-a-fully-linear-model"><i class="fa fa-check"></i>Exercise 1: Evaluating a fully linear model</a></li>
<li class="chapter" data-level="" data-path="splines.html"><a href="splines.html#exercise-2-evaluating-a-spline-model"><i class="fa fa-check"></i>Exercise 2: Evaluating a spline model</a></li>
<li class="chapter" data-level="" data-path="splines.html"><a href="splines.html#extra-variable-scaling"><i class="fa fa-check"></i>Extra! Variable scaling</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Homework</b></span></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html"><i class="fa fa-check"></i>Homework 1</a>
<ul>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#project-work"><i class="fa fa-check"></i>Project Work</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#portfolio-work"><i class="fa fa-check"></i>Portfolio Work</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#course-engagement"><i class="fa fa-check"></i>Course Engagement</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html"><i class="fa fa-check"></i>Homework 2</a>
<ul>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#project-work-1"><i class="fa fa-check"></i>Project Work</a></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#portfolio-work-1"><i class="fa fa-check"></i>Portfolio Work</a></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#course-engagement-1"><i class="fa fa-check"></i>Course Engagement</a></li>
</ul></li>
<li class="part"><span><b>V Project</b></span></li>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html"><i class="fa fa-check"></i>Final Project</a>
<ul>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html#requirements"><i class="fa fa-check"></i>Requirements</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-resources.html"><a href="r-resources.html"><i class="fa fa-check"></i>R Resources</a>
<ul>
<li class="chapter" data-level="" data-path="r-resources.html"><a href="r-resources.html#outside-resources"><i class="fa fa-check"></i>Outside resources</a></li>
<li class="chapter" data-level="" data-path="r-resources.html"><a href="r-resources.html#example-code"><i class="fa fa-check"></i>Example code</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STAT 253: Statistical Machine Learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="knn-regression-and-the-bias-variance-tradeoff" class="section level1" number="6">
<h1><span class="header-section-number">Topic 6</span> KNN Regression and the Bias-Variance Tradeoff</h1>
<div id="learning-goals-4" class="section level2 unnumbered">
<h2>Learning Goals</h2>
<ul>
<li>Clearly describe / implement by hand the KNN algorithm for making a regression prediction</li>
<li>Explain how the number of neighbors relates to the bias-variance tradeoff</li>
<li>Explain the difference between parametric and nonparametric methods</li>
<li>Explain how the curse of dimensionality relates to the performance of KNN</li>
</ul>
<p><br></p>
<p>Slides from today are available <a href="https://docs.google.com/presentation/d/1aNEw_cF4Vj8whvFovEtuU8Eh-qxTejK4DXoiTJGb3Rc/edit?usp=sharing">here</a>.</p>
<p><br><br><br></p>
</div>
<div id="knn-models-in-caret" class="section level2 unnumbered">
<h2>KNN models in <code>caret</code></h2>
<p>To build KNN models in <code>caret</code>, first load the package and set the seed for the random number generator to ensure reproducible results:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb43-1" aria-hidden="true"></a><span class="kw">library</span>(caret)</span>
<span id="cb43-2"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb43-2" aria-hidden="true"></a><span class="kw">set.seed</span>(___) <span class="co"># Pick your favorite number to fill in the parentheses</span></span></code></pre></div>
<p>Then adapt the following code:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb44-1" aria-hidden="true"></a>knn_mod &lt;-<span class="st"> </span><span class="kw">train</span>(</span>
<span id="cb44-2"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb44-2" aria-hidden="true"></a>    y <span class="op">~</span><span class="st"> </span>.,</span>
<span id="cb44-3"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb44-3" aria-hidden="true"></a>    <span class="dt">data =</span> ___,</span>
<span id="cb44-4"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb44-4" aria-hidden="true"></a>    <span class="dt">preProcess =</span> <span class="st">&quot;scale&quot;</span>,</span>
<span id="cb44-5"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb44-5" aria-hidden="true"></a>    <span class="dt">method =</span> <span class="st">&quot;knn&quot;</span>,</span>
<span id="cb44-6"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb44-6" aria-hidden="true"></a>    <span class="dt">tuneGrid =</span> <span class="kw">data.frame</span>(<span class="dt">k =</span> <span class="kw">seq</span>(___, ___, <span class="dt">by =</span> ___)),</span>
<span id="cb44-7"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb44-7" aria-hidden="true"></a>    <span class="dt">trControl =</span> <span class="kw">trainControl</span>(<span class="dt">method =</span> <span class="st">&quot;cv&quot;</span>, <span class="dt">number =</span> ___, <span class="dt">selectionFunction =</span> ___),</span>
<span id="cb44-8"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb44-8" aria-hidden="true"></a>    <span class="dt">metric =</span> <span class="st">&quot;MAE&quot;</span>,</span>
<span id="cb44-9"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb44-9" aria-hidden="true"></a>    <span class="dt">na.action =</span> na.omit</span>
<span id="cb44-10"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb44-10" aria-hidden="true"></a>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>y ~ .</code></td>
<td align="left">Model formula for specifying response and predictors</td>
</tr>
<tr class="even">
<td align="left"><code>data</code></td>
<td align="left">Sample data</td>
</tr>
<tr class="odd">
<td align="left"><code>preProcess</code></td>
<td align="left"><code>"scale"</code> indicates that predictor variables should be scaled to have the same variance (Why might this be important? Should we always do this?)</td>
</tr>
<tr class="even">
<td align="left"><code>method</code></td>
<td align="left"><code>"knn"</code> implements KNN regression (and classification)</td>
</tr>
<tr class="odd">
<td align="left"><code>tuneGrid</code></td>
<td align="left">A mini-dataset (<code>data.frame</code>) of tuning parameters. <span class="math inline">\(k\)</span> is the KNN neighborhood size. Supply a sequence as <code>seq(begin, end, by = size of step)</code>.</td>
</tr>
<tr class="even">
<td align="left"><code>trControl</code></td>
<td align="left">Use cross-validation to estimate test performance for each model fit. The process used to pick a final model from among these is indicated by <code>selectionFunction</code>, with options including <code>"best"</code> and <code>"oneSE"</code>.</td>
</tr>
<tr class="odd">
<td align="left"><code>metric</code></td>
<td align="left">Evaluate and compare competing models with respect to their CV-MAE.</td>
</tr>
<tr class="even">
<td align="left"><code>na.action</code></td>
<td align="left">Set <code>na.action = na.omit</code> to prevent errors if the data has missing values.</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>Note: When including categorical predictors, <code>caret</code> automatically creates the corresponding indicator variables to allow Euclidean distance to still be used. You’ll think about the pros/cons of this in the exercises.</p>
<p>An alternative to creating indicator variables is to use <strong>Gower distance</strong>. We’ll explore Gower distance more when we talk about clustering.</p>
<p><br></p>
<p><strong>Identifying the “best” KNN model</strong></p>
<p>The “best” model in the sequence of models fit is defined relative to the chosen <code>selectionFunction</code> and <code>metric</code>.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb45-1" aria-hidden="true"></a><span class="co"># Plot CV-estimated test performance versus the tuning parameter</span></span>
<span id="cb45-2"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb45-2" aria-hidden="true"></a><span class="kw">plot</span>(knn_mod)</span>
<span id="cb45-3"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb45-3" aria-hidden="true"></a></span>
<span id="cb45-4"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb45-4" aria-hidden="true"></a><span class="co"># CV metrics for each model</span></span>
<span id="cb45-5"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb45-5" aria-hidden="true"></a>knn_mod<span class="op">$</span>results</span>
<span id="cb45-6"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb45-6" aria-hidden="true"></a></span>
<span id="cb45-7"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb45-7" aria-hidden="true"></a><span class="co"># Identify which tuning parameter is &quot;best&quot;</span></span>
<span id="cb45-8"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb45-8" aria-hidden="true"></a>knn_mod<span class="op">$</span>bestTune</span>
<span id="cb45-9"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb45-9" aria-hidden="true"></a></span>
<span id="cb45-10"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb45-10" aria-hidden="true"></a><span class="co"># Get information from all CV iterations for the &quot;best&quot; model</span></span>
<span id="cb45-11"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb45-11" aria-hidden="true"></a>knn_mod<span class="op">$</span>resample</span>
<span id="cb45-12"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb45-12" aria-hidden="true"></a></span>
<span id="cb45-13"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb45-13" aria-hidden="true"></a><span class="co"># Use the best model to make predictions</span></span>
<span id="cb45-14"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb45-14" aria-hidden="true"></a><span class="co"># newdata should be a data.frame with required predictors</span></span>
<span id="cb45-15"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb45-15" aria-hidden="true"></a><span class="kw">predict</span>(knn_mod, <span class="dt">newdata =</span> ___)</span></code></pre></div>
<p><br><br><br></p>
</div>
<div id="exercises-4" class="section level2 unnumbered">
<h2>Exercises</h2>
<p><strong>You can download a template RMarkdown file to start from <a href="template_rmds/06-knn-bvt.Rmd">here</a>.</strong></p>
<p>We’ll explore KNN regression using the <code>College</code> dataset in the <code>ISLR</code> package (install it with <code>install.packages("caret")</code> in the Console). You can use <code>?College</code> in the Console to look at the data codebook.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb46-1" aria-hidden="true"></a><span class="kw">library</span>(caret)</span>
<span id="cb46-2"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb46-2" aria-hidden="true"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb46-3"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb46-3" aria-hidden="true"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb46-4"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb46-4" aria-hidden="true"></a><span class="kw">library</span>(readr)</span>
<span id="cb46-5"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb46-5" aria-hidden="true"></a><span class="kw">library</span>(ISLR)</span>
<span id="cb46-6"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb46-6" aria-hidden="true"></a></span>
<span id="cb46-7"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb46-7" aria-hidden="true"></a><span class="kw">data</span>(College)</span>
<span id="cb46-8"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb46-8" aria-hidden="true"></a></span>
<span id="cb46-9"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb46-9" aria-hidden="true"></a><span class="co"># A little data cleaning</span></span>
<span id="cb46-10"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb46-10" aria-hidden="true"></a>college_clean &lt;-<span class="st"> </span>College <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb46-11"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb46-11" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">school =</span> <span class="kw">rownames</span>(College)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb46-12"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb46-12" aria-hidden="true"></a><span class="st">    </span><span class="kw">filter</span>(Grad.Rate <span class="op">&lt;=</span><span class="st"> </span><span class="dv">100</span>) <span class="co"># Remove one school with grad rate of 118%</span></span>
<span id="cb46-13"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb46-13" aria-hidden="true"></a><span class="kw">rownames</span>(college_clean) &lt;-<span class="st"> </span><span class="ot">NULL</span> <span class="co"># Remove school names as row names</span></span></code></pre></div>
<div id="hello-how-are-things" class="section level3 unnumbered">
<h3>Hello, how are things?</h3>
<p>We’re about a week and a half into our last module of the year - how are you feeling? What’s on your mind?</p>
</div>
<div id="exercise-1-bias-variance-tradeoff-warmup" class="section level3 unnumbered">
<h3>Exercise 1: Bias-variance tradeoff warmup</h3>
<ol style="list-style-type: lower-alpha">
<li>Think back to the LASSO algorithm which depends upon tuning parameter <span class="math inline">\(\lambda\)</span>.
<ul>
<li>For which values of <span class="math inline">\(\lambda\)</span> (small or large) will LASSO be the most biased, and why?</li>
<li>For which values of <span class="math inline">\(\lambda\)</span> (small or large) will LASSO be the most variable, and why?</li>
</ul></li>
<li>The bias-variance tradeoff also comes into play when comparing across algorithms, not just within algorithms. Consider LASSO vs. least squares:
<ul>
<li>Which will tend to be more biased?</li>
<li>Which will tend to be more variable?</li>
<li>When will LASSO outperform least squares in the bias-variance tradeoff?</li>
</ul></li>
</ol>
</div>
<div id="exercise-2-impact-of-distance-metric" class="section level3 unnumbered">
<h3>Exercise 2: Impact of distance metric</h3>
<p>Consider the 1-nearest neighbor algorithm to predict <code>Grad.Rate</code> on the basis of two predictors: <code>Apps</code> and <code>Private</code>. Let <code>Yes</code> for <code>Private</code> be represented with the value 1 and <code>No</code> with 0.</p>
<ol style="list-style-type: lower-alpha">
<li><p>We have a test case whose number of applications is 13,530 and is a private school. Suppose that we have the tiny 2-case training set below. What would the 1-nearest neighbor prediction be using Euclidean distance?</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb47-1" aria-hidden="true"></a>college_clean <span class="op">%&gt;%</span></span>
<span id="cb47-2"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb47-2" aria-hidden="true"></a><span class="st">    </span><span class="kw">filter</span>(school <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Princeton University&quot;</span>, <span class="st">&quot;SUNY at Albany&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb47-3"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb47-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">select</span>(Apps, Private, Grad.Rate, school)</span></code></pre></div></li>
<li><p>Do you have any concerns about the resulting prediction? Based on this, comment on the impact of the distance metric chosen on KNN performance. How might you change the distance calculation (or correspondingly rescale the data) to generate a more sensible prediction in this situation?</p></li>
</ol>
</div>
<div id="exercise-3-implementing-knn-in-caret" class="section level3 unnumbered">
<h3>Exercise 3: Implementing KNN in <code>caret</code></h3>
<p>Adapt our general KNN code to “fit” a set of KNN models with the following specifications:</p>
<ul>
<li>Use the predictors <code>Private</code>, <code>Top10perc</code> (% of new students from top 10% of high school class), and <code>S.F.Ratio</code> (student/faculty ratio).</li>
<li>Use 8-fold CV. (Why 8? Take a look at the sample size.)</li>
<li>Use mean absolute error (MAE) to select a final model.</li>
<li>Select the simplest model for which the metric is within one standard error of the best metric.</li>
<li>Use a sequence of <span class="math inline">\(K\)</span> values from 1 to 100 in increments of 5.</li>
<li>Should you use <code>preProcess = "scale"</code>?</li>
</ul>
<p>After adapting the code (but before inspecting any output), answer the following conceptual questions:</p>
<ul>
<li>Explain your choice for using or not using <code>preProcess = "scale"</code>.</li>
<li>Why is “fit” in quotes? Does KNN actually fit a model as part of training? (This feature of KNN is known as “lazy learning”.)</li>
<li>How is test MAE estimated? What are the steps of the KNN algorithm with cross-validation?</li>
<li>Draw a picture of how you expect test MAE to vary with <span class="math inline">\(K\)</span>. In terms of the bias-variance tradeoff, why do you expect the plot to look this way?</li>
</ul>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb48-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb48-2"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb48-2" aria-hidden="true"></a>knn_mod &lt;-<span class="st"> </span><span class="kw">train</span>(</span>
<span id="cb48-3"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb48-3" aria-hidden="true"></a>    </span>
<span id="cb48-4"><a href="knn-regression-and-the-bias-variance-tradeoff.html#cb48-4" aria-hidden="true"></a>)</span></code></pre></div>
</div>
<div id="exercise-4-inspecting-the-results" class="section level3 unnumbered">
<h3>Exercise 4: Inspecting the results</h3>
<ul>
<li>Use <code>plot(knn_mod)</code> to verify your expectations about the plot of test MAE vs. <span class="math inline">\(K\)</span>.</li>
<li>Contextually interpret the test MAE.</li>
<li>How else could you evaluate the KNN model?</li>
<li>Does your KNN model help you understand which predictors of graduation rate are most important? Why or why not?</li>
</ul>
</div>
<div id="exercise-5-curse-of-dimensionality" class="section level3 unnumbered">
<h3>Exercise 5: Curse of dimensionality</h3>
<p>Just as with parametric models, we could keep going and add more and more predictors. However, the KNN algorithm is known to suffer from the “curse of dimensionality”. Why? <strong>Hint:</strong> First do a quick Google search of this new idea.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="lasso-shrinkageregularization.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="splines.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
