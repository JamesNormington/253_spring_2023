<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Topic 5 Variable Subset Selection | STAT 253: Statistical Machine Learning</title>
  <meta name="description" content="This is the class website for Statistical Machine Learning at Macalester College." />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="Topic 5 Variable Subset Selection | STAT 253: Statistical Machine Learning" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is the class website for Statistical Machine Learning at Macalester College." />
  <meta name="github-repo" content="JamesNormington/253_spring_2023" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Topic 5 Variable Subset Selection | STAT 253: Statistical Machine Learning" />
  
  <meta name="twitter:description" content="This is the class website for Statistical Machine Learning at Macalester College." />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="cross-validation.html"/>
<link rel="next" href="lasso-shrinkageregularization.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="custom_styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href = "./">STAT 253: Statistical Machine Learning</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a></li>
<li class="chapter" data-level="" data-path="schedule-syllabus.html"><a href="schedule-syllabus.html"><i class="fa fa-check"></i>Schedule &amp; Syllabus</a></li>
<li class="chapter" data-level="" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="r-and-rstudio-setup.html"><a href="r-and-rstudio-setup.html"><i class="fa fa-check"></i>R and RStudio Setup</a>
<ul>
<li class="chapter" data-level="" data-path="r-and-rstudio-setup.html"><a href="r-and-rstudio-setup.html#troubleshooting"><i class="fa fa-check"></i>Troubleshooting</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introductions.html"><a href="introductions.html"><i class="fa fa-check"></i><b>1</b> Introductions</a>
<ul>
<li class="chapter" data-level="" data-path="introductions.html"><a href="introductions.html#envisioning-a-community-of-learners"><i class="fa fa-check"></i>Envisioning a Community of Learners</a></li>
<li class="chapter" data-level="" data-path="introductions.html"><a href="introductions.html#explorations"><i class="fa fa-check"></i>Explorations</a></li>
</ul></li>
<li class="part"><span><b>I Regression: Evaluation</b></span></li>
<li class="chapter" data-level="2" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html"><i class="fa fa-check"></i><b>2</b> Evaluating Regression Models</a>
<ul>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#learning-goals"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#exercises"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#context"><i class="fa fa-check"></i>Context</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#class-investigations"><i class="fa fa-check"></i>Class investigations</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#exercise-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#exercise-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#exercise-3"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="evaluating-regression-models.html"><a href="evaluating-regression-models.html#exercise-4"><i class="fa fa-check"></i>Exercise 4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="overfitting.html"><a href="overfitting.html"><i class="fa fa-check"></i><b>3</b> Overfitting</a>
<ul>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#learning-goals-1"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#the-tidymodels-package"><i class="fa fa-check"></i>The <code>tidymodels</code> package</a></li>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#exercises-1"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#context-1"><i class="fa fa-check"></i>Context</a></li>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#exercise-1-5-models"><i class="fa fa-check"></i>Exercise 1: 5 models</a></li>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#exercise-2-evaluating-the-test-data"><i class="fa fa-check"></i>Exercise 2: Evaluating the Test Data</a></li>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#exercise-3-overfitting"><i class="fa fa-check"></i>Exercise 3: Overfitting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cross-validation.html"><a href="cross-validation.html"><i class="fa fa-check"></i><b>4</b> Cross-validation</a>
<ul>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#learning-goals-2"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#exercises-2"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#context-2"><i class="fa fa-check"></i>Context</a></li>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#exercise-1-cross-validation-in-concept"><i class="fa fa-check"></i>Exercise 1: Cross-validation in Concept</a></li>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#exercise-2-cross-validation-with-tidymodels"><i class="fa fa-check"></i>Exercise 2: Cross-validation with <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#exercise-3-looking-at-the-evaluation-metrics"><i class="fa fa-check"></i>Exercise 3: Looking at the evaluation metrics</a></li>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#exercise-4-practical-issues-choosing-k"><i class="fa fa-check"></i>Exercise 4: Practical issues: choosing <span class="math inline">\(k\)</span></a></li>
<li class="chapter" data-level="" data-path="cross-validation.html"><a href="cross-validation.html#digging-deeper"><i class="fa fa-check"></i>Digging deeper</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Regression: Building Models</b></span></li>
<li class="chapter" data-level="5" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html"><i class="fa fa-check"></i><b>5</b> Variable Subset Selection</a>
<ul>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#learning-goals-3"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#exercises-3"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#exercise-1-backward-stepwise-selection-by-hand"><i class="fa fa-check"></i>Exercise 1: Backward stepwise selection: by hand</a></li>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#exercise-2-interpreting-the-results"><i class="fa fa-check"></i>Exercise 2: Interpreting the results</a></li>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#exercise-3-planning-forward-selection-using-cv"><i class="fa fa-check"></i>Exercise 3: Planning forward selection using CV</a></li>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#exercise-4-stepwise-selection-in-caret"><i class="fa fa-check"></i>Exercise 4: Stepwise selection in <code>caret</code></a></li>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#exercise-5-exploring-the-results"><i class="fa fa-check"></i>Exercise 5: Exploring the results</a></li>
<li class="chapter" data-level="" data-path="variable-subset-selection.html"><a href="variable-subset-selection.html#digging-deeper-1"><i class="fa fa-check"></i>Digging deeper</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html"><i class="fa fa-check"></i><b>6</b> LASSO: Shrinkage/Regularization</a>
<ul>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#learning-goals-4"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#lasso-models-in-tidymodels"><i class="fa fa-check"></i>LASSO models in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#exercises-4"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#exercise-1-a-least-squares-model"><i class="fa fa-check"></i>Exercise 1: A least squares model</a></li>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#exercise-2-fitting-a-lasso-model-in-tidymodels"><i class="fa fa-check"></i>Exercise 2: Fitting a LASSO model in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#exercise-3-examining-output-plot-of-coefficient-paths"><i class="fa fa-check"></i>Exercise 3: Examining output: plot of coefficient paths</a></li>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#exercise-4-examining-and-evaluating-the-best-lasso-model."><i class="fa fa-check"></i>Exercise 4: Examining and evaluating the best LASSO model.</a></li>
<li class="chapter" data-level="" data-path="lasso-shrinkageregularization.html"><a href="lasso-shrinkageregularization.html#digging-deeper-2"><i class="fa fa-check"></i>Digging deeper</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Regression: Building Flexible Models</b></span></li>
<li class="chapter" data-level="7" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html"><i class="fa fa-check"></i><b>7</b> KNN Regression and the Bias-Variance Tradeoff</a>
<ul>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#learning-goals-5"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#knn-models-in-tidymodels"><i class="fa fa-check"></i>KNN models in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#exercises-5"><i class="fa fa-check"></i>Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#exercise-1-bias-variance-tradeoff-warmup"><i class="fa fa-check"></i>Exercise 1: Bias-variance tradeoff warmup</a></li>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#exercise-2-impact-of-distance-metric"><i class="fa fa-check"></i>Exercise 2: Impact of distance metric</a></li>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#exercise-3-implementing-knn-in-tidymodels"><i class="fa fa-check"></i>Exercise 3: Implementing KNN in <code>tidymodels</code></a></li>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#exercise-4-inspecting-the-results"><i class="fa fa-check"></i>Exercise 4: Inspecting the results</a></li>
<li class="chapter" data-level="" data-path="knn-regression-and-the-bias-variance-tradeoff.html"><a href="knn-regression-and-the-bias-variance-tradeoff.html#exercise-5-curse-of-dimensionality"><i class="fa fa-check"></i>Exercise 5: Curse of dimensionality</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Homework</b></span></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html"><i class="fa fa-check"></i>Homework 1</a>
<ul>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#project-work"><i class="fa fa-check"></i>Project Work</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#ethics-in-ml"><i class="fa fa-check"></i>Ethics in ML</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#portfolio-work"><i class="fa fa-check"></i>Portfolio Work</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html"><i class="fa fa-check"></i>Homework 2</a>
<ul>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#project-work-1"><i class="fa fa-check"></i>Project Work</a></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#ethics-in-ml-1"><i class="fa fa-check"></i>Ethics in ML</a></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#portfolio-work-1"><i class="fa fa-check"></i>Portfolio Work</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-resources.html"><a href="r-resources.html"><i class="fa fa-check"></i>R Resources</a>
<ul>
<li class="chapter" data-level="" data-path="r-resources.html"><a href="r-resources.html#outside-resources"><i class="fa fa-check"></i>Outside resources</a></li>
<li class="chapter" data-level="" data-path="r-resources.html"><a href="r-resources.html#example-code"><i class="fa fa-check"></i>Example code</a></li>
</ul></li>
<li class="part"><span><b>V Project</b></span></li>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html"><i class="fa fa-check"></i>Final Project</a>
<ul>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html#requirements"><i class="fa fa-check"></i>Requirements</a></li>
<li class="chapter" data-level="" data-path="final-project.html"><a href="final-project.html#grading-rubric"><i class="fa fa-check"></i>Grading Rubric</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STAT 253: Statistical Machine Learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="variable-subset-selection" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Topic 5</span> Variable Subset Selection<a href="variable-subset-selection.html#variable-subset-selection" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="learning-goals-3" class="section level2 unnumbered hasAnchor">
<h2>Learning Goals<a href="variable-subset-selection.html#learning-goals-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Clearly describe the forward and backward stepwise selection algorithm and why they are examples of greedy algorithms</li>
<li>Compare best subset and stepwise algorithms in terms of optimality of output and computational time</li>
<li>Describe how selection algorithms can give a measure of <em>variable importance</em></li>
</ul>
<p><br><br><br></p>
</div>
<div id="exercises-3" class="section level2 unnumbered hasAnchor">
<h2>Exercises<a href="variable-subset-selection.html#exercises-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>You can download a template RMarkdown file to start from <a href="template_rmds/04-subset-selection.Rmd">here</a>.</strong></p>
<p>We’ll continue using the body fat dataset to explore subset selection methods.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="variable-subset-selection.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb29-2"><a href="variable-subset-selection.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb29-3"><a href="variable-subset-selection.html#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb29-4"><a href="variable-subset-selection.html#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb29-5"><a href="variable-subset-selection.html#cb29-5" aria-hidden="true" tabindex="-1"></a>bodyfat <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;http://www.macalester.edu/~ajohns24/data/bodyfatsub.csv&quot;</span>)</span>
<span id="cb29-6"><a href="variable-subset-selection.html#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="variable-subset-selection.html#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Take out the redundant Density and HeightFt variables</span></span>
<span id="cb29-8"><a href="variable-subset-selection.html#cb29-8" aria-hidden="true" tabindex="-1"></a>bodyfat <span class="ot">&lt;-</span> bodyfat <span class="sc">%&gt;%</span> </span>
<span id="cb29-9"><a href="variable-subset-selection.html#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>Density, <span class="sc">-</span>HeightFt)</span></code></pre></div>
<div id="exercise-1-backward-stepwise-selection-by-hand" class="section level3 unnumbered hasAnchor">
<h3>Exercise 1: Backward stepwise selection: by hand<a href="variable-subset-selection.html#exercise-1-backward-stepwise-selection-by-hand" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the backward stepwise procedure, we start with the full model, <code>full_model</code>, with <em>all</em> predictors:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="variable-subset-selection.html#cb30-1" aria-hidden="true" tabindex="-1"></a>full_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(BodyFat <span class="sc">~</span> Age <span class="sc">+</span> Weight <span class="sc">+</span> Height <span class="sc">+</span> Neck <span class="sc">+</span> Chest <span class="sc">+</span> Abdomen <span class="sc">+</span> Hip <span class="sc">+</span> Thigh <span class="sc">+</span> Knee <span class="sc">+</span> Ankle <span class="sc">+</span> Biceps <span class="sc">+</span> Forearm <span class="sc">+</span> Wrist, <span class="at">data =</span> bodyfat)</span></code></pre></div>
<p>To practice the backward selection algorithm, step through a few steps of the algorithm using p-values as a selection criterion:</p>
<ul>
<li><p>Identify which predictor contributes the <em>least</em> to the model. One (problematic) approach is to identify the least significant predictor.</p></li>
<li><p>Fit a new model which eliminates this predictor.</p></li>
<li><p>Identify the least significant predictor in this model.</p></li>
<li><p>Fit a new model which eliminates this predictor.</p></li>
<li><p>Repeat 1 more time to get the hang of it.</p></li>
</ul>
<p>(We discussed in the video how the use of p-values for selection is problematic, but for now you’re just getting a handle on the algorithm. You’ll think about the problems with p-values in the next exercise.)</p>
</div>
<div id="exercise-2-interpreting-the-results" class="section level3 unnumbered hasAnchor">
<h3>Exercise 2: Interpreting the results<a href="variable-subset-selection.html#exercise-2-interpreting-the-results" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Examine which predictors remain after the previous exercise. Are you surprised that, for example, <code>Wrist</code> is still in the model but <code>Weight</code> is not? Does this mean that <code>Wrist</code> is a better predictor of body fat percentage than <code>Weight</code> is? What statistical idea is relevant here?</p>
</div>
<div id="exercise-3-planning-forward-selection-using-cv" class="section level3 unnumbered hasAnchor">
<h3>Exercise 3: Planning forward selection using CV<a href="variable-subset-selection.html#exercise-3-planning-forward-selection-using-cv" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Using p-values to perform stepwise selection has problems, as was discussed in the video. A better alternative to target predictive accuracy is to evaluate the models using cross-validation.</p>
<p>Fully outline the steps required to use cross-validation to perform <strong>forward</strong> selection. Make sure to provide enough detail such that the stepwise selection and CV algorithms are made clear.</p>
</div>
<div id="exercise-4-stepwise-selection-in-caret" class="section level3 unnumbered hasAnchor">
<h3>Exercise 4: Stepwise selection in <code>caret</code><a href="variable-subset-selection.html#exercise-4-stepwise-selection-in-caret" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Run <code>install.packages("leaps")</code> in the Console to install the <code>leaps</code> package before proceeding.</p>
<p>Complete the <code>caret</code> code below to perform backward stepwise selection with cross-validation. The following points will help you complete the code:</p>
<ul>
<li>In R model formulas, <code>y ~ .</code> sets <code>y</code> as the outcome and all other predictors in the dataset as predictors.</li>
<li>The specific method name for backward selection is <code>"leapBackward"</code>.</li>
<li>The <code>tuneGrid</code> argument is already filled in. It allows us to input <strong>tuning parameters</strong> into the fitting process. The tuning parameters for subset selection are the number of variables included in the models explored (<code>nvmax</code>). This can vary from 1 to 13 (the maximum number of predictors possible).</li>
<li>Use 10-fold CV to estimate test performance of the models.</li>
<li>Use <code>"MAE"</code> as the evaluation <code>metric</code> to choose how the best of the 1-variable, 2-variable, etc. models will be chosen.</li>
</ul>
<p>(<strong>Note:</strong> CV is only used to pick among the best 1, 2, 3, …, and 13 variable models. To find the best 1, 2, 3, …, and 13 variable models, training MSE is used. <code>caret</code> uses training MSE because within a subset size, all models have the same number of coefficients, which makes both ordinary R-squared and training MSE ok for comparing models.)</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="variable-subset-selection.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">23</span>)</span>
<span id="cb31-2"><a href="variable-subset-selection.html#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="variable-subset-selection.html#cb31-3" aria-hidden="true" tabindex="-1"></a>back_step_mod <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb31-4"><a href="variable-subset-selection.html#cb31-4" aria-hidden="true" tabindex="-1"></a>    y <span class="sc">~</span> x,</span>
<span id="cb31-5"><a href="variable-subset-selection.html#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> bodyfat,</span>
<span id="cb31-6"><a href="variable-subset-selection.html#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> ___,</span>
<span id="cb31-7"><a href="variable-subset-selection.html#cb31-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">tuneGrid =</span> <span class="fu">data.frame</span>(<span class="at">nvmax =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>),</span>
<span id="cb31-8"><a href="variable-subset-selection.html#cb31-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">trControl =</span> ___,</span>
<span id="cb31-9"><a href="variable-subset-selection.html#cb31-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">metric =</span> ___,</span>
<span id="cb31-10"><a href="variable-subset-selection.html#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.action =</span> na.omit</span>
<span id="cb31-11"><a href="variable-subset-selection.html#cb31-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="exercise-5-exploring-the-results" class="section level3 unnumbered hasAnchor">
<h3>Exercise 5: Exploring the results<a href="variable-subset-selection.html#exercise-5-exploring-the-results" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are a number of ways to examine and use the output of the selection algorithm, which we’ll explore here. (It would be useful to make notes along the way - perhaps on your code note sheet.)</p>
<div id="part-a" class="section level4 unnumbered hasAnchor">
<h4>Part a<a href="variable-subset-selection.html#part-a" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s first examine the sequence of models explored. The stars in the table at the bottom indicate the variables included in the 1-variable, 2-variable, etc. models.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="variable-subset-selection.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(back_step_mod)</span></code></pre></div>
<ul>
<li><p>Of the 13 models in the sequence, R only prints out the 11 smallest models (since, for reasons we’ll discuss below, it determines the 11 predictor model to be “best”).</p></li>
<li><p>Which predictor is the last to remain in the model? Second-to-last to remain? How do you think we could use these results to identify which predictors were most/least important in predicting the outcome of body fat percentage?</p></li>
</ul>
</div>
<div id="part-b" class="section level4 unnumbered hasAnchor">
<h4>Part b<a href="variable-subset-selection.html#part-b" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Examine the 10-fold CV MAE for each of the 13 models in the backward stepwise sequence:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="variable-subset-selection.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot metrics for each model in the sequence</span></span>
<span id="cb33-2"><a href="variable-subset-selection.html#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(back_step_mod)</span>
<span id="cb33-3"><a href="variable-subset-selection.html#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="variable-subset-selection.html#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at accuracy/error metrics for the different subset sizes</span></span>
<span id="cb33-5"><a href="variable-subset-selection.html#cb33-5" aria-hidden="true" tabindex="-1"></a>back_step_mod<span class="sc">$</span>results</span></code></pre></div>
<ul>
<li>Which size model has the lowest CV MAE?</li>
<li>Which size model would you pick? Why?</li>
</ul>
</div>
<div id="part-c" class="section level4 unnumbered hasAnchor">
<h4>Part c<a href="variable-subset-selection.html#part-c" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In our model code, we used <code>selectionFunction = "best"</code> by default inside <code>trainControl()</code>. By doing so, we indicated that we wanted to find which model minimizes the CV MAE (i.e., has the “best” MAE). With respect to this criterion:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="variable-subset-selection.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># What tuning parameter gave the best performance?</span></span>
<span id="cb34-2"><a href="variable-subset-selection.html#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># i.e. What subset size gave the best model?</span></span>
<span id="cb34-3"><a href="variable-subset-selection.html#cb34-3" aria-hidden="true" tabindex="-1"></a>back_step_mod<span class="sc">$</span>bestTune</span>
<span id="cb34-4"><a href="variable-subset-selection.html#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="variable-subset-selection.html#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain the coefficients for the best model</span></span>
<span id="cb34-6"><a href="variable-subset-selection.html#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(back_step_mod<span class="sc">$</span>finalModel, <span class="at">id =</span> back_step_mod<span class="sc">$</span>bestTune<span class="sc">$</span>nvmax)</span>
<span id="cb34-7"><a href="variable-subset-selection.html#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="variable-subset-selection.html#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain the coefficients of any size model with at most as many variables as the overall best model (e.g., the 2-predictor model)</span></span>
<span id="cb34-9"><a href="variable-subset-selection.html#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(back_step_mod<span class="sc">$</span>finalModel, <span class="at">id =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>Another sensible choice for the selection function is to not choose the model with the lowest estimated error but to account for the uncertainty in the estimation of that test error by picking the smallest model for which the CV MAE is within one standard error of the minimum CV MAE. What do you think the rationale for this is?</p>
<p>(We’ll explore the code for this formally later, or you can try it out below in the Digging Deeper section.)</p>
</div>
<div id="part-d" class="section level4 unnumbered hasAnchor">
<h4>Part d<a href="variable-subset-selection.html#part-d" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We should end by evaluating our final chosen model.</p>
<ul>
<li>Contextually interpret (with units) the CV MAE for the model.</li>
<li>Make residual plots for the chosen model in one of 2 ways: (1) use <code>lm()</code> to fit the model with the chosen predictors or (2) use the following code to create a dataset called <code>back_step_mod_out</code> which contains the original data as well as predicted values and residuals (<code>fitted</code> and <code>resid</code>).</li>
</ul>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="variable-subset-selection.html#cb35-1" aria-hidden="true" tabindex="-1"></a>back_step_mod_out <span class="ot">&lt;-</span> bodyfat <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="variable-subset-selection.html#cb35-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb35-3"><a href="variable-subset-selection.html#cb35-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">fitted =</span> <span class="fu">predict</span>(back_step_mod, <span class="at">newdata =</span> bodyfat),</span>
<span id="cb35-4"><a href="variable-subset-selection.html#cb35-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">resid =</span> BodyFat <span class="sc">-</span> fitted</span>
<span id="cb35-5"><a href="variable-subset-selection.html#cb35-5" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
</div>
</div>
<div id="digging-deeper-1" class="section level3 unnumbered hasAnchor">
<h3>Digging deeper<a href="variable-subset-selection.html#digging-deeper-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>As mentioned in Exercise 5c, we have another choice for the <code>selectionFunction</code> used to choose from many possible models. The use of <code>selectionFunction = "oneSE"</code> below picks the simplest model for which the CV MAE is within one standard error of the minimum CV MAE. Compare the output you obtain here with your best model from Exercise 5.</li>
</ol>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="variable-subset-selection.html#cb36-1" aria-hidden="true" tabindex="-1"></a>back_step_mod_1se <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb36-2"><a href="variable-subset-selection.html#cb36-2" aria-hidden="true" tabindex="-1"></a>    BodyFat <span class="sc">~</span> .,</span>
<span id="cb36-3"><a href="variable-subset-selection.html#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> bodyfat,</span>
<span id="cb36-4"><a href="variable-subset-selection.html#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">&quot;leapBackward&quot;</span>,</span>
<span id="cb36-5"><a href="variable-subset-selection.html#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">tuneGrid =</span> <span class="fu">data.frame</span>(<span class="at">nvmax =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>),</span>
<span id="cb36-6"><a href="variable-subset-selection.html#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;cv&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>, <span class="at">selectionFunction =</span> <span class="st">&quot;oneSE&quot;</span>),</span>
<span id="cb36-7"><a href="variable-subset-selection.html#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">metric =</span> <span class="st">&quot;MAE&quot;</span>,</span>
<span id="cb36-8"><a href="variable-subset-selection.html#cb36-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.action =</span> na.omit</span>
<span id="cb36-9"><a href="variable-subset-selection.html#cb36-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Forward selection can be implemented in <code>caret</code> with analogous code, except that the method name is <code>"leapForward"</code>. Try implementing forward selection and comparing your results.</li>
</ol>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="cross-validation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lasso-shrinkageregularization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
